<html>
 <body>
  <h1>xLabs Software Developer Kit: Video preview</h1>
  <p>xLabs automates most of the code needed to embed our video stream in the page. You just need to insert an element with id=xLabsPreview and toggle config property 'frame.stream.preview' as this demo shows.</p>
  <p style=" color: red">Troubleshooting: you need to enable "Allow access to file URLs" for the xlabs plugin in the chrome extension settings.</p>
  <p style=" color: red">Note: Webcam access doesn't work from file:// URLs. See:
http://stackoverflow.com/questions/13723699/chrome-getusermedia-not-requesting-permission-locally </p>
  <p style=" color: red">You can run Chrome with --allow-file-access-from-files to allow this, or run a local webserver.</p>
  <h2>Preview</h2>
  <button id="camera-start">Start camera</button>
  <button id="camera-stop">Stop camera</button>
  <button id="preview-start">Start preview</button>
  <button id="preview-stop">Stop preview</button>
  <br>
  <video id="xLabsPreview" autoplay></video>
  <script src="../api/xlabs.js"></script>
  <script type="text/javascript">

  var Demo = {

    cameraStart : function() {
      xLabs.setConfig( "frame.stream.enabled", "1" );
    },
    cameraStop : function() {
      xLabs.setConfig( "frame.stream.enabled", "0" );
    },

    previewStart : function() {
      xLabs.setConfig( "frame.stream.preview", "1" );
    },
    previewStop : function() {
      xLabs.setConfig( "frame.stream.preview", "0" );
    }

  };

  xLabs.setup( null, null, null, "myToken" );
  
  var buttons = document.querySelectorAll( 'button' );
  
  [].forEach.call( buttons, function( button ) {
    button.addEventListener( 'click', function( e ) {
      switch( e.target.id ) {
        case 'camera-start' : Demo.cameraStart(); break; 
        case 'camera-stop'  : Demo.cameraStop(); break; 
        case 'preview-start' : Demo.previewStart(); break; 
        case 'preview-stop'  : Demo.previewStop(); break; 
      }
    } ); // event listener
  } ); // call

  </script>
 </body>
</html>

